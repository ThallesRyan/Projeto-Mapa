<!DOCTYPE html>
<html lang="pt-br">

<head>
	<meta http-equiv="Content-Type" content="text/html" charset='utf-8'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="autor" content="Miguel Gastelumendi">
	<title>Objetivo - Arnia: Part 1</title>
</head>

<body>
	<!-- onload="aoAbrir()"> -->
	<script type="text/javascript">

		var olMap = null;
		var olGps = null;
		var olFeatureCenter = null;
		const iSrid = 4326;
		function doMap() {
			// Aqui part 1 mostrar imagem
			var map = document.getElementById('idMapViewPort');
			map.removeAttribute('hidden');

		}

		function centerMap() {
		}

		function changeLayer() {
		}


		// function openGps() {
		// }

		// // function aoAbrir() {
		// // 	const apiKey = "77474b92ad49cef81948263cf3ca9477"


		// // 	const ip = '187.72.14.228'
		// // 	const api = `https://ip.city/api.php?ip=187.72.14.228&key=77474b92ad49cef81948263cf3ca9477`

		// // }

		function pesquisarCordenadas() {

			let texto = document.getElementById('TextArea').value
			let objeto = JSON.parse(texto);
			console.log(objeto.IP)

			const apiKey = "77474b92ad49cef81948263cf3ca9477"

			const ip = objeto.IP
			const api = `https://ip.city/api.php?ip=${ip}&key=${apiKey}`

			console.log(document.getElementById('frame').setAttribute("src", api))
		}

		function cordenadas() {
			let dados = document.getElementById('dadosIp').value
			let objeto = JSON.parse(dados)
			console.log(objeto.long)
			console.log(objeto.lat)

			document.getElementById("idLon").value = objeto.long
			document.getElementById("idLat").value = objeto.lat
		}

		function gerarPaises() {
			const url = `https://servicodados.ibge.gov.br/api/v1/paises`



			async function fetchDataAsync(url) {
				const response = await fetch(url);
				return await response.json();
			}

			fetchDataAsync(url)
				.then(dados => {
					const nomes = dados.map(dados => dados.nome).map(dados => dados.abreviado)
					

					// document.getElementById('selectPaises').inser
					// document.getElementById('op2').innerHTML = nomes[0].abreviado
					// document.getElementById('op2').value = nomes[0].abreviado

					console.log(nomes)
					nomes.sort()
					console.log(nomes)
					

					nomes.forEach(item => {
						addOption(item)
					})

					function addOption(valor) {
						var option = new Option(valor, valor);
						var select = document.getElementById("selectPaises");
						select.add(option);
					}
				})





		}
	</script>

	<div id="menu">
		<div>
			<img src="logo.png" alt="Arnia" id="logo">
			<br>
			<button type="button" id="idDoMap" onClick="doMap()">Mostrar mapa</button>

			<br>
			<button type="button" id="idChangeLayer" onClick="changeLayer()">Alterar Camada</button>
			<br>

			<form action="http://satelier.dynu.net/psgfdemo/Argow/action_g_arnia" method="get" target="mostraIp">
				<!-- form action="http://localhost:59599/Argow/action_g_arnia" method="get" target="_blank" -->
				<!--<input type= "text" id="nome2" name="nome" value="Thalles">-->
				<!--<input type= "password" id="senha2" name="senha" value="">-->
				<input type="submit" value="Pegar IP">
			</form>

			<br>
			<iframe style="height: 100px; width: 500px;" name="mostraIp"></iframe>
			<br>
			<textarea onchange="pesquisarCordenadas()" id="TextArea" style="width: 500px; height: 100px;"></textarea>


			</form>

			<br>

			<iframe style="height: 100px; width: 500px;" name="" id="frame"></iframe>
			<br>
			<textarea onchange="cordenadas()" id="dadosIp" style="height: 100px; width: 500px;"></textarea>
			<br>
			<br>
			<div>
				<select id="selectPaises">
					<option id="op1" value="">Países</option>
					

				</select>
				<button id="botaoPaises" onclick="gerarPaises()">Gerar Países</button>
			</div>
			<br>
			<br>
			<button type="button" id="idOpenGps" onClick="openGps()" disabled>GPS</button>
		</div>

	</div>

	<div id="dados">
		<div id="entrada">
			<span class="input-label">Longitude</span>
			<input type="text" id="idLon" name="idLon" value='-43.9360313'><br>
			<span class="input-label">Latidude</span>
			<input type="text" id="idLat" name="idLat" value='-19.9315584'>
		</div>


		<div id="mapa">
			<!--
                <div id="idMapViewPort" style="width: 90%; min-width: 200px; height: 600px"> </div>
			-->
			<img id="idMapViewPort" src='mapa.png' hidden>

		</div>


		<footer>
		</footer>

		<style>
			#selectPaises{
				min-width:200px;
				max-width: 200px;
				background-color: darkcyan;
				color: white;
				text-align: center;
			}
			#botaoPaises{
				background-color: darkcyan;
				color: white;
			}
		</style>
</body>

</html>